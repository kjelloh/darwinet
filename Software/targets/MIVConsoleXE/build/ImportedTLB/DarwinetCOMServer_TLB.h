// ************************************************************************ //
// WARNING                                                                    
// -------                                                                    
// The types declared in this file were generated from data read from a       
// Type Library. If this type library is explicitly or indirectly (via        
// another type library referring to this type library) re-imported, or the   
// 'Refresh' command of the Type Library Editor activated while editing the   
// Type Library, the contents of this file will be regenerated and all        
// manual modifications will be lost.                                         
// ************************************************************************ //

// $Rev: 46046 $
// File generated on 2013-05-09 11:22:18 from Type Library described below.

// ************************************************************************  //
// Type Lib: C:\subversion\darwinet\trunk\Software\targets\DarwinetCOMServerXE\build\.\Win32\Debug\DarwinetCOMServerXE.exe (1)
// LIBID: {C10A9DE6-1B79-4C29-8CD8-B621544D80F2}
// LCID: 0
// Helpfile: 
// HelpString: 
// DepndLst: 
//   (1) v2.0 stdole, (C:\Windows\SysWOW64\stdole2.tlb)
// SYS_KIND: SYS_WIN32
// ************************************************************************ //
#ifndef   DarwinetCOMServer_TLBH
#define   DarwinetCOMServer_TLBH

#pragma option push -b -a4 -w-inl -w-8118

#if !defined(__UTILCLS_H)
#include <utilcls.h>
#endif
#if !defined(__UTILCLS_H_VERSION) || (__UTILCLS_H_VERSION < 0x0700)
//
// The code generated by the TLIBIMP utility or the Import|TypeLibrary 
// and Import|ActiveX feature of C++Builder rely on specific versions of
// the header file UTILCLS.H found in the INCLUDE\VCL directory. If an 
// older version of the file is detected, you probably need an update/patch.
//
#error "This file requires a newer version of the header UTILCLS.H" \
       "You need to apply an update/patch to your copy of C++Builder"
#endif
#include <olectl.h>
#include <ocidl.h>
#if defined(USING_ATLVCL) || defined(USING_ATL)
#if !defined(__TLB_NO_EVENT_WRAPPERS)
#include <atl/atlmod.h>
#endif
#endif

#include <StdVCL.hpp>

typedef TComInterface<System::Win::Stdvcl::IStrings> IStringsPtr;
typedef TComInterface<System::Win::Stdvcl::IStringsDisp> IStringsDispPtr;

namespace Darwinetcomserver_tlb
{

// *********************************************************************//
// HelpString: 
// Version:    1.0
// *********************************************************************//


// *********************************************************************//
// GUIDS declared in the TypeLibrary. Following prefixes are used:        
//   Type Libraries     : LIBID_xxxx                                      
//   CoClasses          : CLSID_xxxx                                      
//   DISPInterfaces     : DIID_xxxx                                       
//   Non-DISP interfaces: IID_xxxx                                        
// *********************************************************************//
extern __declspec (package) const GUID LIBID_DarwinetCOMServer;
extern __declspec (package) const GUID IID_IDarwinetEngine;
extern __declspec (package) const GUID DIID_IDarwinetEngineEvents;
extern __declspec (package) const GUID CLSID_DarwinetEngine;
extern __declspec (package) const GUID IID_IDarwinetDomain;
extern __declspec (package) const GUID DIID_IDarwinetDomainEvents;
extern __declspec (package) const GUID CLSID_DarwinetDomain;

// *********************************************************************//
// Forward declaration of types defined in TypeLibrary                    
// *********************************************************************//
interface DECLSPEC_UUID("{46E64180-5D7F-4DA7-BB2A-EA6266E56E25}") IDarwinetEngine;
typedef TComInterface<IDarwinetEngine, &IID_IDarwinetEngine> IDarwinetEnginePtr;

interface DECLSPEC_UUID("{A58D7352-6FE6-4D38-B3A1-77F2B520AD2E}") IDarwinetEngineEvents;
typedef TComInterface<IDarwinetEngineEvents, &DIID_IDarwinetEngineEvents> IDarwinetEngineEventsPtr;

interface DECLSPEC_UUID("{80F91A0A-11F2-4711-A5ED-59345387133B}") IDarwinetDomain;
typedef TComInterface<IDarwinetDomain, &IID_IDarwinetDomain> IDarwinetDomainPtr;

interface DECLSPEC_UUID("{2F2CF59F-3D77-4538-AC4E-33BB0BEC9DDD}") IDarwinetDomainEvents;
typedef TComInterface<IDarwinetDomainEvents, &DIID_IDarwinetDomainEvents> IDarwinetDomainEventsPtr;


// *********************************************************************//
// Declaration of CoClasses defined in Type Library                       
// (NOTE: Here we map each CoClass to its Default Interface)              
//                                                                        
// The LIBID_OF_ macro(s) map a LIBID_OF_CoClassName to the GUID of this  
// TypeLibrary. It simplifies the updating of macros when CoClass name    
// change.                                                                
// *********************************************************************//
typedef IDarwinetEngine DarwinetEngine;
typedef IDarwinetEnginePtr DarwinetEnginePtr;
typedef IDarwinetDomain DarwinetDomain;
typedef IDarwinetDomainPtr DarwinetDomainPtr;

#define LIBID_OF_DarwinetEngine (&LIBID_DarwinetCOMServer)
#define LIBID_OF_DarwinetDomain (&LIBID_DarwinetCOMServer)
// *********************************************************************//
// Interface: IDarwinetEngine
// Flags:     (4416) Dual OleAutomation Dispatchable
// GUID:      {46E64180-5D7F-4DA7-BB2A-EA6266E56E25}
// *********************************************************************//
interface IDarwinetEngine  : public IDispatch
{
public:
  // [201] Returns an interface to a darwinet Domain instance
  virtual Darwinetcomserver_tlb::IDarwinetDomain* STDMETHODCALLTYPE getDomain(void) = 0;

#if !defined(__TLB_NO_INTERFACE_WRAPPERS)



#endif //   __TLB_NO_INTERFACE_WRAPPERS

};

// *********************************************************************//
// Interface: IDarwinetEngineEvents
// Flags:     (4096) Dispatchable
// GUID:      {A58D7352-6FE6-4D38-B3A1-77F2B520AD2E}
// *********************************************************************//
interface IDarwinetEngineEvents : public TDispWrapper<IDispatch>
{
  HRESULT __fastcall onCreated()
  {
    _TDispID _dispid(/* onCreated */ DISPID(201));
    return OleFunction(_dispid);
  }


};
// *********************************************************************//
// Interface: IDarwinetDomain
// Flags:     (4416) Dual OleAutomation Dispatchable
// GUID:      {80F91A0A-11F2-4711-A5ED-59345387133B}
// *********************************************************************//
interface IDarwinetDomain  : public IDispatch
{
public:

#if !defined(__TLB_NO_INTERFACE_WRAPPERS)



#endif //   __TLB_NO_INTERFACE_WRAPPERS

};

// *********************************************************************//
// Interface: IDarwinetDomainEvents
// Flags:     (4096) Dispatchable
// GUID:      {2F2CF59F-3D77-4538-AC4E-33BB0BEC9DDD}
// *********************************************************************//
interface IDarwinetDomainEvents : public TDispWrapper<IDispatch>
{

};
#if !defined(__TLB_NO_INTERFACE_WRAPPERS)
// *********************************************************************//
// SmartIntf: TCOMIDarwinetEngine
// Interface: IDarwinetEngine
// *********************************************************************//
template <class T /* IDarwinetEngine */ >
class TCOMIDarwinetEngineT : public TComInterface<IDarwinetEngine>, public TComInterfaceBase<IUnknown>
{
public:
  TCOMIDarwinetEngineT() {}
  TCOMIDarwinetEngineT(IDarwinetEngine *intf, bool addRef = false) : TComInterface<IDarwinetEngine>(intf, addRef) {}
  TCOMIDarwinetEngineT(const TCOMIDarwinetEngineT& src) : TComInterface<IDarwinetEngine>(src) {}
  TCOMIDarwinetEngineT& operator=(const TCOMIDarwinetEngineT& src) { Bind(src, true); return *this;}

  Darwinetcomserver_tlb::IDarwinetDomain* __fastcall getDomain(void);

};
typedef TCOMIDarwinetEngineT<IDarwinetEngine> TCOMIDarwinetEngine;

// *********************************************************************//
// DispIntf:  IDarwinetEngine
// Flags:     (4416) Dual OleAutomation Dispatchable
// GUID:      {46E64180-5D7F-4DA7-BB2A-EA6266E56E25}
// *********************************************************************//
template<class T>
class IDarwinetEngineDispT : public TAutoDriver<IDarwinetEngine>
{
public:
  IDarwinetEngineDispT(){}

  IDarwinetEngineDispT(IDarwinetEngine *pintf)
  {
    TAutoDriver<IDarwinetEngine>::Bind(pintf, false);
  }

  IDarwinetEngineDispT(IDarwinetEnginePtr pintf)
  {
    TAutoDriver<IDarwinetEngine>::Bind(pintf, true);
  }

  IDarwinetEngineDispT& operator=(IDarwinetEngine *pintf)
  {
    TAutoDriver<IDarwinetEngine>::Bind(pintf, false);
    return *this;
  }

  IDarwinetEngineDispT& operator=(IDarwinetEnginePtr pintf)
  {
    TAutoDriver<IDarwinetEngine>::Bind(pintf, true);
    return *this;
  }

  HRESULT BindDefault()
  {
    return OLECHECK(Bind(CLSID_DarwinetEngine));
  }

  HRESULT BindRunning()
  {
    return BindToActive(CLSID_DarwinetEngine);
  }

  Darwinetcomserver_tlb::IDarwinetDomain* __fastcall getDomain();

};
typedef IDarwinetEngineDispT<IDarwinetEngine> IDarwinetEngineDisp;

// *********************************************************************//
// DispIntf:  IDarwinetEngineEvents
// Flags:     (4096) Dispatchable
// GUID:      {A58D7352-6FE6-4D38-B3A1-77F2B520AD2E}
// *********************************************************************//
template <class T>
class IDarwinetEngineEventsDispT : public TAutoDriver<IDarwinetEngineEvents>
{
public:
  IDarwinetEngineEventsDispT(){}

  void Attach(LPUNKNOWN punk)
  { m_Dispatch = static_cast<T*>(punk); }

  HRESULT         __fastcall onCreated();

};
typedef IDarwinetEngineEventsDispT<IDarwinetEngineEvents> IDarwinetEngineEventsDisp;

// *********************************************************************//
// SmartIntf: TCOMIDarwinetDomain
// Interface: IDarwinetDomain
// *********************************************************************//
template <class T /* IDarwinetDomain */ >
class TCOMIDarwinetDomainT : public TComInterface<IDarwinetDomain>, public TComInterfaceBase<IUnknown>
{
public:
  TCOMIDarwinetDomainT() {}
  TCOMIDarwinetDomainT(IDarwinetDomain *intf, bool addRef = false) : TComInterface<IDarwinetDomain>(intf, addRef) {}
  TCOMIDarwinetDomainT(const TCOMIDarwinetDomainT& src) : TComInterface<IDarwinetDomain>(src) {}
  TCOMIDarwinetDomainT& operator=(const TCOMIDarwinetDomainT& src) { Bind(src, true); return *this;}


};
typedef TCOMIDarwinetDomainT<IDarwinetDomain> TCOMIDarwinetDomain;

// *********************************************************************//
// DispIntf:  IDarwinetDomain
// Flags:     (4416) Dual OleAutomation Dispatchable
// GUID:      {80F91A0A-11F2-4711-A5ED-59345387133B}
// *********************************************************************//
template<class T>
class IDarwinetDomainDispT : public TAutoDriver<IDarwinetDomain>
{
public:
  IDarwinetDomainDispT(){}

  IDarwinetDomainDispT(IDarwinetDomain *pintf)
  {
    TAutoDriver<IDarwinetDomain>::Bind(pintf, false);
  }

  IDarwinetDomainDispT(IDarwinetDomainPtr pintf)
  {
    TAutoDriver<IDarwinetDomain>::Bind(pintf, true);
  }

  IDarwinetDomainDispT& operator=(IDarwinetDomain *pintf)
  {
    TAutoDriver<IDarwinetDomain>::Bind(pintf, false);
    return *this;
  }

  IDarwinetDomainDispT& operator=(IDarwinetDomainPtr pintf)
  {
    TAutoDriver<IDarwinetDomain>::Bind(pintf, true);
    return *this;
  }

  HRESULT BindDefault()
  {
    return OLECHECK(Bind(CLSID_DarwinetDomain));
  }

  HRESULT BindRunning()
  {
    return BindToActive(CLSID_DarwinetDomain);
  }


};
typedef IDarwinetDomainDispT<IDarwinetDomain> IDarwinetDomainDisp;

// *********************************************************************//
// DispIntf:  IDarwinetDomainEvents
// Flags:     (4096) Dispatchable
// GUID:      {2F2CF59F-3D77-4538-AC4E-33BB0BEC9DDD}
// *********************************************************************//
template <class T>
class IDarwinetDomainEventsDispT : public TAutoDriver<IDarwinetDomainEvents>
{
public:
  IDarwinetDomainEventsDispT(){}

  void Attach(LPUNKNOWN punk)
  { m_Dispatch = static_cast<T*>(punk); }


};
typedef IDarwinetDomainEventsDispT<IDarwinetDomainEvents> IDarwinetDomainEventsDisp;

// *********************************************************************//
// SmartIntf: TCOMIDarwinetEngine
// Interface: IDarwinetEngine
// *********************************************************************//
template <class T> Darwinetcomserver_tlb::IDarwinetDomain* __fastcall
TCOMIDarwinetEngineT<T>::getDomain(void)
{
  return (*this)->getDomain();
}

// *********************************************************************//
// DispIntf:  IDarwinetEngine
// Flags:     (4416) Dual OleAutomation Dispatchable
// GUID:      {46E64180-5D7F-4DA7-BB2A-EA6266E56E25}
// *********************************************************************//
template <class T> Darwinetcomserver_tlb::IDarwinetDomain* __fastcall
IDarwinetEngineDispT<T>::getDomain()
{
  _TDispID _dispid(*this, OLETEXT("getDomain"), DISPID(201));
  TAutoArgs<0> _args;
  OleFunction(_dispid, _args);
  return (Darwinetcomserver_tlb::IDarwinetDomain* /*[C1]*/)(LPDISPATCH) /*[VT_DISPATCH:1]*/_args.GetRetVariant();
}

// *********************************************************************//
// DispIntf:  IDarwinetEngineEvents
// Flags:     (4096) Dispatchable
// GUID:      {A58D7352-6FE6-4D38-B3A1-77F2B520AD2E}
// *********************************************************************//
template <class T> HRESULT __fastcall
IDarwinetEngineEventsDispT<T>::onCreated()
{
  _TDispID _dispid(/* onCreated */ DISPID(201));
  return OleFunction(_dispid);
}

// *********************************************************************//
// SmartIntf: TCOMIDarwinetDomain
// Interface: IDarwinetDomain
// *********************************************************************//
// *********************************************************************//
// DispIntf:  IDarwinetDomain
// Flags:     (4416) Dual OleAutomation Dispatchable
// GUID:      {80F91A0A-11F2-4711-A5ED-59345387133B}
// *********************************************************************//
// *********************************************************************//
// DispIntf:  IDarwinetDomainEvents
// Flags:     (4096) Dispatchable
// GUID:      {2F2CF59F-3D77-4538-AC4E-33BB0BEC9DDD}
// *********************************************************************//
// *********************************************************************//
// The following typedefs expose classes (named CoCoClassName) that       
// provide static Create() and CreateRemote(LPWSTR machineName) methods   
// for creating an instance of an exposed object. These functions can     
// be used by client wishing to automate CoClasses exposed by this        
// typelibrary.                                                           
// *********************************************************************//

// *********************************************************************//
// COCLASS DEFAULT INTERFACE CREATOR
// CoClass  : DarwinetEngine
// Interface: TCOMIDarwinetEngine
// *********************************************************************//
typedef TCoClassCreatorT<TCOMIDarwinetEngine, IDarwinetEngine, &CLSID_DarwinetEngine, &IID_IDarwinetEngine> CoDarwinetEngine;

// *********************************************************************//
// COCLASS DEFAULT INTERFACE CREATOR
// CoClass  : DarwinetDomain
// Interface: TCOMIDarwinetDomain
// *********************************************************************//
typedef TCoClassCreatorT<TCOMIDarwinetDomain, IDarwinetDomain, &CLSID_DarwinetDomain, &IID_IDarwinetDomain> CoDarwinetDomain;
#endif  //   __TLB_NO_INTERFACE_WRAPPERS


#if !defined(__TLB_NO_EVENT_WRAPPERS) && defined(USING_ATLVCL)
// *********************************************************************//
// CONNECTIONPOINT/EVENT PROXY
// CoClass         : DarwinetEngine
// Event Interface : IDarwinetEngineEvents
// *********************************************************************//
template <class T>
class TEvents_DarwinetEngine : public IConnectionPointImpl<T,
                                                 &DIID_IDarwinetEngineEvents,
#if !defined(_TLB_DYNAMIC_CONNECTIONPOINT_ARRAY)
                                                 CComUnkArray<CONNECTIONPOINT_ARRAY_SIZE> >
#else
                                                 CComDynamicArray>
#endif
{
public:
  HRESULT         Fire_onCreated(void);
protected:
  IDarwinetEngineEventsDisp m_EventIntfObj;
};

template <class T> HRESULT
TEvents_DarwinetEngine<T>::Fire_onCreated(void)
{
  T * pT = (T*)this;
  pT->Lock();
  IUnknown ** pp = m_vec.begin();
  while (pp < m_vec.end())
  {
    if (*pp != NULL)
    {
      m_EventIntfObj.Attach(*pp);
      m_EventIntfObj.onCreated();
      m_EventIntfObj.Attach(0);
    }
    pp++;
  }
  pT->Unlock();
  return S_OK;
}

// *********************************************************************//
// CONNECTIONPOINT/EVENT PROXY
// CoClass         : DarwinetDomain
// Event Interface : IDarwinetDomainEvents
// *********************************************************************//
template <class T>
class TEvents_DarwinetDomain : public IConnectionPointImpl<T,
                                                 &DIID_IDarwinetDomainEvents,
#if !defined(_TLB_DYNAMIC_CONNECTIONPOINT_ARRAY)
                                                 CComUnkArray<CONNECTIONPOINT_ARRAY_SIZE> >
#else
                                                 CComDynamicArray>
#endif
{
public:
protected:
  IDarwinetDomainEventsDisp m_EventIntfObj;
};

#endif    //   __TLB_NO_EVENT_WRAPPERS

#if !defined(__TLB_NO_EVENT_WRAPPERS) && defined(USING_DAX)
// *********************************************************************//
// CONNECTIONPOINT/EVENT PROXY
// CoClass         : DarwinetEngine
// Event Interface : IDarwinetEngineEvents
// *********************************************************************//
template <typename T>
class IDarwinetEngine_EventsDispatcher : public IUnknown
{
public:
  HRESULT Fire_onCreated(void)
  {
    IDarwinetEngineEventsDisp dispInvoker;
    T* pClass = static_cast<T*>(this);
    TConnectionPointSinkList<T> cpsl(pClass->ConnectionPoint);
    if (cpsl.HasConnectionPoint()) {
      for (int i=0; i<cpsl.GetCount(); i++) {
        _di_IInterface punk;
        if (cpsl.GetSink(i, punk) && (dispInvoker.Bind(punk)==S_OK))
          dispInvoker.onCreated();
      }
    }
    return S_OK;
  }

};

// *********************************************************************//
// CONNECTIONPOINT/EVENT PROXY
// CoClass         : DarwinetDomain
// Event Interface : IDarwinetDomainEvents
// *********************************************************************//
template <typename T>
class IDarwinetDomain_EventsDispatcher : public IUnknown
{
public:
};

#endif    //   __TLB_NO_EVENT_WRAPPERS

};     // namespace Darwinetcomserver_tlb

#if !defined(NO_IMPLICIT_NAMESPACE_USE)
using  namespace Darwinetcomserver_tlb;
#endif

#pragma option pop

#endif // DarwinetCOMServer_TLBH
